# shogi-winner-predict-model
将棋のプロ棋士の棋譜とレーティングのデータを収集していろんな情報から勝敗予測をするモデル

## ※注意
将棋連盟の規約に違反することや、データのサイズが膨大であることから、データセットは本リポジトリには保管されていません。
データセットに関しては`./crower`のプログラムを実行して入手したり、手動で行ってください。
また、クローラプログラムの実行の際はDDoS攻撃にならないように、アクセスの間隔には十分配慮の上で使用してください。(さらに言えばアクセス感覚をこれ以上縮めないことをお勧めします。)
本クローラプログラムを使用して障害を引き起こした場合、開発者は一切の責任を負いません。

## 概要
評価値以外の情報も学習することで、プロ棋士の将棋の対局の局面を与えた際に勝敗を予測するモデルと、そのデータセット作成のために使ったプログラムを補完するためのリポジトリ。
知識情報システム実習Bの一環(課題：新規性のある機械学習モデルの実装)で作成。
局面やそれに伴う評価値だけでなく、棋士の調子や残り時間といった情報を学習データとして加えることで、より正確な勝敗予測が可能かを実験する。

## ディレクトリ構成
- `./annotation` : アノテーションファイルの保管場所
    - anno.csv: 初期のデータセットに対応したアノテーションファイル(sfen情報のみ, いくつかデータセットに問題があり没)
    - anno_less.csv: 1つの棋譜のすべてではなく、5つの局面をランダムに切り出したデータセットのアノテーションファイル
    - anno_norm.csv: 上記データセットでは正規化が追い付いていなかった情報に関しての正規化処理を行ったデータセットのアノテーションファイル
    - anno_{*}_train.csv: 学習データとテストデータを固定したい場合の学習データセット。{*}には上記(less/norm)のような特性が入ります。
    - anno_{*}_test.csv: 学習データとテストデータを固定したい場合のテストデータセット。{*}には上記(less/norm)のような特性が入ります。
- `./crower`: 棋譜のクローラ、ファイル名が棋戦に対応。(非公式レーティングのクローラは`./tools`以下
- `./tools`: 各種ツールのプログラム
    - `convert_sjis.py`: utf-8で棋譜ファイルを保存してしまった場合、将棋ソフトの入力用にShift-Jisに変換するだけのプログラム
    - `createFormats.py`: 棋譜ファイルの情報を整理して、正規化を行ったり必要な情報を関数として返すためのプログラム。別プログラムで本ツールから取り出した情報を一旦JSON形式でデータセットを作成して保存するような処理を行っている。
    - `data2vec.py`: SFEN情報と先手と後手の棋士番号、評価値、残り時間を入力することで情報をNumpy行列として返すためのプログラム
    - `data2vec_norm.py`: 上記プログラムで正規化がされていなかった駒情報を正規化してNumpy行列として返すプログラム
    - `kishi.py`: 棋士の名前から棋士番号を取得するための辞書プログラム
    - `PatternFacter.py`: 棋譜ファイルから必要な情報を切り出したり、学習データとして使用できる棋譜ファイルか(古い棋譜だと持ち時間の記載がないのでデータセットとして使えない)を判定したりするためのツール。
    - `player_rate.py`: [将棋連盟　棋士別成績一覧](http://kishibetsu.com/)さんからレーティング情報を取得するためのクローラプログラム
    
## notebook(拡張子は省略)
※記載がないファイルについてはテストのために使ったもので本筋とはあまり関係がない
- `create_datasets`: データセット(CSV)とアノテーションファイルを作成するためのノートブック。下記プログラムから出力されたJsonデータを使用
- `create_jsondatasets`: toolsのプログラムを使用して棋譜ファイルを整形してJsonデータとして卸すためのノートブック。上記ノートブックでJsonデータを使用
- `eval-archive1`: 過去に没になったモデルのノートブック、ログを残すために残してある
- `eval-devide`: メインで使用している深層学習のプログラム。normデータセットを使用してCNNで勝敗予測モデルを構築する。
